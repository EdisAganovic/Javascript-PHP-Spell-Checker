/** Javascript/PHP Spell Checker v1.1 https://github.com/LPology/Javascript-PHP-Spell-Checker */ 
var sc=sc||{};sc._=function(a){return document.getElementById(a)};sc.objectKeys=function(a){var b,c=[];if("object"!==typeof a)return!1;for(b in a)a.hasOwnProperty(b)&&c.push(b);return c};sc.obj2string=function(a,b){var c=[],d;if("object"!==typeof a)return"";for(d in a)if(a.hasOwnProperty(d)){var e=b?b+"["+d+"]":d,g=a[d];c.push("object"===typeof g?sc.obj2string(g,e):encodeURIComponent(e)+"="+encodeURIComponent(g))}return c.join("&")};
sc.extendObj=function(a,b){var c;if("object"!==typeof a||"object"!==typeof b)return!1;for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return!0};sc.trim=function(a){return a.toString().replace(/^\s+/,"").replace(/\s+$/,"")};sc.getId=function(){var a=0;return function(){a++;return a+(new Date).getTime()}}();sc.addEvent=function(a,b,c){"string"===typeof a&&(a=sc._(a));a.attachEvent?(a["e"+b+c]=c,a[b+c]=function(){a["e"+b+c](window.event)},a.attachEvent("on"+b,a[b+c])):a.addEventListener(b,c,!1)};
sc.removeEvent=function(a,b,c){"string"===typeof a&&(a=sc._(a));a.detachEvent?(a.detachEvent("on"+b,a[b+c]),a[b+c]=null):a.removeEventListener(b,c,!1)};sc.findIndex=function(a,b,c){var d,e,g=1;d=0;for(e=a.length;d<e;d++)if(a[d]==b){if(g==c)return d;g++}return!1};sc.newXHR=function(){if(void 0!==typeof XMLHttpRequest)return new window.XMLHttpRequest;if(window.ActiveXObject)try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(a){}};
sc.evalJSON=function(a){var b={};if(!a||"string"!==typeof a)return b={success:!1};a=sc.trim(a);if(window.JSON&&window.JSON.parse)try{b=window.JSON.parse(a)}catch(c){b={success:!1}}else try{b=eval("("+a+")")}catch(d){b={success:!1}}return b};
sc.verifyElem=function(a){a.jquery?a=a[0]:"string"===typeof a&&(/^#.*/.test(a)&&(a=a.slice(1)),a=document.getElementById(a));if(!a||1!==a.nodeType)return!1;"A"==a.nodeName.toUpperCase()&&sc.addEvent(a,"click",function(a){if(a&&a.preventDefault)a.preventDefault();else if(window.event)window.event.returnValue=false});return a};
sc.SpellChecker=function(a){this._settings={action:"",button:"",textInput:"",name:"text",data:{}};sc.extendObj(this._settings,a);this._button=sc.verifyElem(this._settings.button);this._textInput=sc.verifyElem(this._settings.textInput);if(!1===this._button)throw Error("Invalid button. Make sure the element you're passing exists.");if(!1===this._textInput)throw Error("Invalid text field. Make sure the element you're passing exists.");this._serverURL=this._settings.action;this._isOpen=this._uniqueID=
this._previousMatchOffset=this._previousWordMatches=this._undoPrevious=this._canUndo=this._matchOffset=this._wordMatches=this._currentWord=this._wordKeys=this._wordObject=this._text=null;this.enable()};
sc.SpellChecker.prototype={enable:function(){var a=this,b,c;a._isOpen=!1;a._uniqueID=sc.getId();a._createHTML();sc.addEvent(a._button,"click",function(){a._openChecker()});sc.addEvent("spelling-ignore"+a._uniqueID,"click",function(){a._ignoreChange()});sc.addEvent("spelling-ignore-all"+a._uniqueID,"click",function(){a._ignoreChange(!0)});sc.addEvent("spell-change"+a._uniqueID,"click",function(){a._makeChange()});sc.addEvent("spell-change-all"+a._uniqueID,"click",function(){a._makeChange(!0)});sc.addEvent("spell-close"+
a._uniqueID,"click",function(){a._closeChecker()});sc.addEvent("spell-msg-close"+a._uniqueID,"click",function(){a._closeChecker()});sc.addEvent("spell-undo"+a._uniqueID,"click",function(){!1!==a._canUndo&&a._undoChange()});b=sc._("spell-current"+a._uniqueID);c=sc._("spell-context"+a._uniqueID);sc.addEvent(b,"click",function(){sc._("spelling-suggestions"+a._uniqueID).selectedIndex=-1});sc.addEvent(c,"click",function(){sc._("spelling-suggestions"+a._uniqueID).selectedIndex=-1});sc.addEvent(b,"keyup",
function(){var a=c.getElementsByTagName("span")[0];a&&a.firstChild&&(a.firstChild.nodeValue=this.value)});sc.addEvent(c,"keyup",function(){var a=this.getElementsByTagName("span")[0];a&&a.firstChild&&(b.value=a.firstChild.nodeValue)})},_openChecker:function(){var a=this,b=a._textInput.value;!0!==a._isOpen&&(a._isOpen=!0,a._canUndo=!1,a._text=b,sc._("spell-overlay"+a._uniqueID).style.display="block",a._esc=function(b){27===b.keyCode&&!0===a._isOpen&&a._closeChecker()},sc.addEvent(document,"keyup",a._esc),
a._notifyMsg("checking"),a._sendData())},_closeChecker:function(){!0===this._isOpen&&(sc._("spell-modal"+this._uniqueID).style.display="none",sc._("spell-overlay"+this._uniqueID).style.display="none",this._isOpen=this._previousMatchOffset=this._previousWordMatches=this._undoPrevious=this._canUndo=this._matchOffset=this._wordMatches=this._currentWord=this._wordKeys=this._wordObject=this._text=null,sc.removeEvent(document,"keyup",this._esc))},_showReviewer:function(){sc._("spell-msg"+this._uniqueID).style.display=
"none";sc._("spelling-inner"+this._uniqueID).style.display="block";sc._("spell-modal"+this._uniqueID).style.cssText="width:480px;height:390px;margin-left:-240px;margin-top:-195px;display:block;"},_notifyMsg:function(a){var b,c=sc._("spell-msg-close-box"+this._uniqueID),d=106,e=53;"checking"==a?(b="Checking...",c.style.display="none",d=86,e=43):c.style.display="block";"servererror"==a&&(b="We have experienced an error and cannot complete the spell check.");"noerrors"==a&&(b="Spell check completed. No errors found.");
"finished"==a&&(b="Spell check completed");sc._("spelling-inner"+this._uniqueID).style.display="none";sc._("spell-msg-text"+this._uniqueID).innerHTML=b;sc._("spell-msg"+this._uniqueID).style.display="block";sc._("spell-modal"+this._uniqueID).style.cssText="width:290px;height:auto;min-height:"+d+"px;margin-left:-145px;margin-top:-"+e+"px;display:block;"},_ignoreChange:function(a){var b=this._wordKeys,c=this._wordMatches,d=this._matchOffset;!0===a||1>=c||d===c?(b.splice(0,1),this._wordMatches=0,this._matchOffset=
1):this._matchOffset=d+1;this._wordKeys=b;0<b.length?this._reviewWord():this._notifyMsg("finished")},_makeChange:function(a){var b=this._text,c=this._currentWord,d=this._wordMatches,e=this._matchOffset,g=sc._("spelling-suggestions"+this._uniqueID),j=g.selectedIndex,k=RegExp(c,"g"),i=this._wordKeys,f=0,h;sc._("spell-hidden"+this._uniqueID).value=b;this._undoPrevious=c;this._previousWordMatches=d;this._previousMatchOffset=e;this._canUndo=!0;h=-1<j?g.options[j].text:sc._("spell-current"+this._uniqueID).value;
b=b.replace(k,function(b){f++;return!0===a||e===f?h:b});!0===a||1>=d||e===d?(i.splice(0,1),this._wordMatches=0,this._matchOffset=1):this._matchOffset=e+=1;this._text=this._textInput.value=b;this._wordKeys=i;0<i.length?this._reviewWord():this._notifyMsg("finished")},_undoChange:function(){var a=this._undoPrevious,b=this._previousWordMatches,c=this._previousMatchOffset,d=sc._("spell-hidden"+this._uniqueID),e=d.value;this._text=this._textInput.value=e;this._currentWord=sc._("spell-current"+this._uniqueID).value=
a;this._wordKeys.unshift(a);this._wordMatches=b;this._matchOffset=c;this._canUndo=!1;d.value="";this._setSuggestionOptions();this._setContextBox()},_setSuggestionOptions:function(){var a=this._wordObject,b=this._currentWord,c=sc._("spelling-suggestions"+this._uniqueID),a=a[b],b=a.length,d;c.options.length=0;if(!(1>b)){for(d=0;d<b;d++)c.options[d]=new Option(a[d],a[d]);c.selectedIndex=0}},_setContextBox:function(){var a=this._currentWord,b=a.length,c=this._matchOffset,d=this._text,e=d.length,g=sc._("spell-context"+
this._uniqueID),j=0;d.replace(RegExp(a,"g"),function(k,i){j++;if(j===c){var f,h;f=i-20;h=i+b;f=0>f?d.substr(0,i):d.substr(f,20);h=h+50>e?d.substr(h):d.substr(h,50);f=f+'<span class="word-highlight">'+a+"</span>"+h;i+b+2<e&&(f=f.replace(/^\s+/,"").replace(/\s+$/,"").replace(/[^\s]+/,"").replace(/[^\s]+$/,"").replace(/^\s+/,"").replace(/\s+$/,""));g.innerHTML=f}return k})},_reviewWord:function(){var a=this._wordKeys[0],b=RegExp(a,"g");this._currentWord=a;sc._("spell-current"+this._uniqueID).value=a;
this._wordMatches=this._text.match(b).length;this._matchOffset=1;this._setSuggestionOptions();this._setContextBox()},_begin:function(a){var b=sc._("spell-hidden"+this._uniqueID);a.success&&!0===a.success&&(a.errors&&!0===a.errors?(b.value=this._text,this._canUndo=!1,this._wordObject=a.words,this._wordKeys=a=sc.objectKeys(this._wordObject),this._showReviewer(),this._reviewWord()):this._notifyMsg("noerrors"))},_handleXHR:function(a){a=sc.trim(a.responseText);a=sc.evalJSON(a);!1!==a?this._begin(a):this._notifyMsg("servererror")},
_sendData:function(){var a=this,b=a._serverURL,c=a._text,d=sc.newXHR(),e;2>c.length?a._notifyMsg("noerrors"):(e=a._settings.name+"=",e+=encodeURIComponent(c),e=e+"&"+sc.obj2string(a._settings.data),d.onreadystatechange=function(){4===d.readyState&&(200===d.status?a._handleXHR(d):a._notifyMsg("servererror"))},d.open("POST",b,!0),d.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),d.send(e))},_createHTML:function(){var a=document.createElement("div"),b=document.createElement("div"),
c=document.createElement("textarea");document.body.appendChild(a);a.setAttribute("id","spell-overlay"+this._uniqueID);a.className="spell-check-overlay";document.body.appendChild(b);b.setAttribute("id","spell-modal"+this._uniqueID);b.className="spell-wrap";b.innerHTML='<div class="spell-header">Spell Check</div><div id="spelling-inner'+this._uniqueID+'" class="spelling-inner"><div class="clearleft">Not found in dictionary:</div><div class="spell-nf"><input type="text" class="current" id="spell-current'+
this._uniqueID+'" /><div class="context" contenteditable="true" id="spell-context'+this._uniqueID+'"></div></div><div class="spell-ignorebtns"><button id="spelling-ignore'+this._uniqueID+'" type="button">Ignore</button><button id="spelling-ignore-all'+this._uniqueID+'" type="button">Ignore All</button></div><div class="clearleft top5">Suggestions:</div><div class="spell-suggest"><select size="8" id="spelling-suggestions'+this._uniqueID+'"><option></option></select></div><div class="spell-changebtns"><button type="button" id="spell-change'+
this._uniqueID+'">Change</button><button id="spell-change-all'+this._uniqueID+'">Change All</button><button type="button" id="spell-undo'+this._uniqueID+'">Undo</button></div><hr /><div class="close-box"><button type="button" id="spell-close'+this._uniqueID+'">Close</button></div></div><div id="spell-msg'+this._uniqueID+'" class="spell-msg"><div class="spell-msg-inner"><span id="spell-msg-text'+this._uniqueID+'"></span></div><div class="spell-msg-inner" id="spell-msg-close-box'+this._uniqueID+'"><button id="spell-msg-close'+
this._uniqueID+'">OK</button></div></div>';c.setAttribute("id","spell-hidden"+this._uniqueID);c.style.display="none";document.body.appendChild(c)}};