/** Javascript/PHP Spell Checker v1.3.3 https://github.com/LPology/Javascript-PHP-Spell-Checker Copyright 2012-2013 LPology, LLC Released under the MIT license */
var sc=sc||{};sc._=function(a){return document.getElementById(a)};sc.objectKeys=function(a){var b,c=[];if("object"!==typeof a)return!1;for(b in a)a.hasOwnProperty(b)&&c.push(b);return c};sc.obj2string=function(a,b){var c=[],d;if("object"!==typeof a)return"";for(d in a)if(a.hasOwnProperty(d)){var e=b?b+"["+d+"]":d,f=a[d];c.push("object"===typeof f?sc.obj2string(f,e):encodeURIComponent(e)+"="+encodeURIComponent(f))}return c.join("&")};
sc.extendObj=function(a,b){var c;if("object"!==typeof a||"object"!==typeof b)return!1;for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return!0};sc.contains=function(a,b){for(var c=a.length;c--;)if(a[c]===b)return!0;return!1};sc.trim=function(a){return a.toString().replace(/^\s+/,"").replace(/\s+$/,"")};sc.getId=function(){var a=0,b=(new Date).getTime();return function(){return b+a++}}();
sc.addEvent=function(a,b,c){"string"===typeof a&&(a=document.getElementById(a));a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener(b,c,!1)};sc.removeEvent=function(a,b,c){"string"===typeof a&&(a=document.getElementById(a));a.attachEvent?a.detachEvent("on"+b,c):a.removeEventListener(b,c,!1)};sc.newXHR=function(){if(void 0!==typeof XMLHttpRequest)return new window.XMLHttpRequest;if(window.ActiveXObject)try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(a){return!1}};
sc.encodeHTML=function(a){return String(a).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};
sc.parseJSON=function(a){if(!a||"string"!==typeof a)return!1;a=sc.trim(a);if(window.JSON&&window.JSON.parse)try{return window.JSON.parse(a)}catch(b){return!1}return a&&/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,"@").replace(/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))?(new Function("return "+a))():!1};
sc.verifyElem=function(a){"undefined"!==typeof jQuery&&a instanceof jQuery?a=a[0]:"string"===typeof a&&(/^#.*/.test(a)&&(a=a.slice(1)),a=document.getElementById(a));if(!a||1!==a.nodeType)return!1;"A"==a.nodeName.toUpperCase()&&sc.addEvent(a,"click",function(a){a&&a.preventDefault?a.preventDefault():window.event&&(window.event.returnValue=!1)});return a};
sc.SpellChecker=function(a){var b=this;b._settings={action:"",button:"",textInput:"",name:"text",data:{}};sc.extendObj(this._settings,a);this._button=sc.verifyElem(this._settings.button);this._textInput=sc.verifyElem(this._settings.textInput);if(!1===this._button)throw Error("Invalid button. Make sure the element you're passing exists.");if(!1===this._textInput)throw Error("Invalid text field. Make sure the element you're passing exists.");this._closeOnEsc=function(a){27===a.keyCode&&b._closeChecker()};
this._serverURL=b._settings.action;this._isOpen=this._uniqueID=this._previousMatchOffset=this._previousWordMatches=this._undoPrevious=this._canUndo=this._matchOffset=this._wordMatches=this._currentWord=this._wordKeys=this._wordObject=this._text=null;this.enable()};
sc.SpellChecker.prototype={enable:function(){var a=this,b,c;a._isOpen=!1;a._uniqueID=sc.getId();a._createHTML();b=sc._("spell-current"+a._uniqueID);c=sc._("spell-context"+a._uniqueID);a._button.className+=" spellcheck-trigger";sc.addEvent(a._button,"click",function(){a._openChecker()});sc.addEvent("spelling-ignore"+a._uniqueID,"click",function(){a._ignoreChange()});sc.addEvent("spelling-ignore-all"+a._uniqueID,"click",function(){a._ignoreChange(!0)});sc.addEvent("spell-change"+a._uniqueID,"click",
function(){a._makeChange()});sc.addEvent("spell-change-all"+a._uniqueID,"click",function(){a._makeChange(!0)});sc.addEvent("spell-close"+a._uniqueID,"click",function(){a._closeChecker()});sc.addEvent("spell-msg-close"+a._uniqueID,"click",function(){a._closeChecker()});sc.addEvent("spell-undo"+a._uniqueID,"click",function(){!1!==a._canUndo&&a._undoChange()});sc.addEvent(b,"click",function(){sc._("spelling-suggestions"+a._uniqueID).selectedIndex=-1});sc.addEvent(c,"click",function(){sc._("spelling-suggestions"+
a._uniqueID).selectedIndex=-1});sc.addEvent(b,"keyup",function(){var a=c.getElementsByTagName("span")[0];a&&a.firstChild&&(a.firstChild.nodeValue=this.value)});sc.addEvent(c,"keyup",function(){var a=this.getElementsByTagName("span")[0];a&&a.firstChild&&(b.value=a.firstChild.nodeValue)})},_openChecker:function(){!0!==this._isOpen&&(this._text=this._textInput.value,sc._("spell-undo"+this._uniqueID).setAttribute("disabled",!0),sc._("spell-overlay"+this._uniqueID).style.display="block",sc._("spell-modal"+
this._uniqueID).style.display="block",this._canUndo=!1,this._isOpen=!0,sc.addEvent(document,"keyup",this._closeOnEsc),this._notifyMsg("a"),this._sendData())},_closeChecker:function(){!0===this._isOpen&&(sc._("spell-msg"+this._uniqueID).style.display="none",sc._("spell-modal"+this._uniqueID).style.cssText="z-index:4999; display:none;",sc._("spell-overlay"+this._uniqueID).style.display="none",sc._("spell-current"+this._uniqueID).value="",sc._("spell-context"+this._uniqueID).innerHTML="",sc._("spelling-suggestions"+
this._uniqueID).options.length=0,this._isOpen=this._previousMatchOffset=this._previousWordMatches=this._undoPrevious=this._canUndo=this._matchOffset=this._wordMatches=this._currentWord=this._wordKeys=this._wordObject=this._text=null,sc.removeEvent(document,"keyup",this._closeOnEsc))},_showReviewer:function(){sc._("spell-msg"+this._uniqueID).style.display="none";sc._("spell-modal"+this._uniqueID).style.zIndex=5001},_notifyMsg:function(a){var b,c=sc._("spell-msg-close-box"+this._uniqueID);"a"==a?(b=
"Checking...",c.style.display="none"):c.style.display="block";"b"==a&&(b="We have experienced an error and cannot complete the spell check.");"c"==a&&(b="Spell check completed. No errors found.");"d"==a&&(b="Spell check completed");sc._("spell-modal"+this._uniqueID).style.zIndex=4999;sc._("spell-msg-text"+this._uniqueID).innerHTML=b;sc._("spell-msg"+this._uniqueID).style.display="block"},_ignoreChange:function(a){var b=this._wordMatches,c=this._matchOffset;!0===a||1>=b||c===b?(this._wordKeys.splice(0,
1),this._matchOffset=1,a=!1):(this._matchOffset=c+1,a=!0);sc._("spell-undo"+this._uniqueID).setAttribute("disabled",!0);this._canUndo=!1;0<this._wordKeys.length||!0===a?this._reviewWord():this._notifyMsg("d")},_makeChange:function(a){var b=this._text,c=this._currentWord,d=this._wordMatches,e=this._matchOffset,f=sc._("spelling-suggestions"+this._uniqueID),l=f.selectedIndex,m=RegExp(c,"g"),k=0,h;sc._("spell-hidden"+this._uniqueID).value=b;this._undoPrevious=c;this._previousWordMatches=d;this._previousMatchOffset=
e;sc._("spell-undo"+this._uniqueID).removeAttribute("disabled");this._canUndo=!0;h=-1<l?f.options[l].text:sc._("spell-current"+this._uniqueID).value;b=b.replace(m,function(b){k++;return!0===a||e===k?h:b});!0===a||1>=d||e===d?(this._wordKeys.splice(0,1),this._matchOffset=1,d=!1):d=!0;this._text=this._textInput.value=b;0<this._wordKeys.length||!0===d?this._reviewWord():this._notifyMsg("d")},_undoChange:function(){var a=this._undoPrevious,b=sc._("spell-hidden"+this._uniqueID),c=b.value;this._text=this._textInput.value=
c;this._currentWord=sc._("spell-current"+this._uniqueID).value=a;sc.contains(this._wordKeys,a)||this._wordKeys.unshift(a);this._wordMatches=this._previousWordMatches;this._matchOffset=this._previousMatchOffset;this._canUndo=!1;sc._("spell-undo"+this._uniqueID).setAttribute("disabled",!0);b.value="";this._setSuggestionOptions();this._setContextBox()},_setSuggestionOptions:function(){var a=this._wordObject,b=this._currentWord,c=sc._("spelling-suggestions"+this._uniqueID),a=a[b],b=a.length,d;c.options.length=
0;if(!(1>b)){for(d=0;d<b;d++)c.options[d]=new Option(a[d],a[d]);c.selectedIndex=0}},_setContextBox:function(){var a=this._currentWord,b=a.length,c=this._matchOffset,d=this._text,e=d.length,f=sc._("spell-context"+this._uniqueID),l=/^\w+$/,m=0;d.replace(RegExp(a,"g"),function(k,h){if(l.test(d.substr(h+b,1)))return k;m++;if(m===c){var j,g;j=h-20;g=h+b;j=0>j?d.substr(0,h):d.substr(j,20);g=g+50>e?d.substr(g):d.substr(g,50);j=j.replace(/^\s+/,"").replace(/[^\s]+/,"").replace(/^\s+/,"");g=g.replace(/\s+$/,
"").replace(/[^\s]+$/,"").replace(/\s+$/,"");f.innerHTML=sc.encodeHTML(j)+'<span class="word-highlight">'+sc.encodeHTML(a)+"</span>"+sc.encodeHTML(g)}return k})},_reviewWord:function(){var a=this._wordKeys[0];this._currentWord=a;sc._("spell-current"+this._uniqueID).value=a;this._wordMatches=this._getTotalWordMatches();this._setSuggestionOptions();this._setContextBox()},_getTotalWordMatches:function(){var a=this,b=this._currentWord.length,c=/^\w+$/,d=0;a._text.replace(RegExp(this._currentWord,"g"),
function(e,f){c.test(a._text.substr(f+b,1))||d++;return e});return d},_begin:function(a){a.success&&!0===a.success&&(a.errors&&!0===a.errors?(sc._("spell-hidden"+this._uniqueID).value=this._text,this._canUndo=!1,this._wordObject=a.words,this._wordKeys=sc.objectKeys(this._wordObject),this._matchOffset=1,this._showReviewer(),this._reviewWord()):this._notifyMsg("c"))},_handleXHR:function(a){a=sc.parseJSON(sc.trim(a.responseText));!1!==a?this._begin(a):this._notifyMsg("b")},_sendData:function(){var a=
this,b=sc.newXHR(),c=a._text,d;!1===b?a._notifyMsg("b"):2>c.length?a._notifyMsg("c"):(d=a._settings.name+"=",d+=encodeURIComponent(c),d=d+"&"+sc.obj2string(a._settings.data),b.onreadystatechange=function(){4===b.readyState&&(200===b.status?a._handleXHR(b):a._notifyMsg("b"))},b.open("POST",a._serverURL,!0),b.setRequestHeader("Accept","application/json, text/javascript, */*; q=0.01"),b.setRequestHeader("X-Requested-With","XMLHttpRequest"),b.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),
b.send(d))},_createHTML:function(){var a=document.createElement("div"),b=document.createElement("div"),c=document.createElement("div"),d=document.createElement("textarea");document.body.appendChild(a);a.className="spell-check-overlay";a.setAttribute("id","spell-overlay"+this._uniqueID);document.body.appendChild(b);b.className="spell-wrap";b.setAttribute("id","spell-modal"+this._uniqueID);b.innerHTML='<div class="spell-header">Spell Check</div><div id="spelling-inner'+this._uniqueID+'" class="spelling-inner"><div class="clearleft">Not found in dictionary:</div><div class="spell-nf"><input type="text" class="current" id="spell-current'+
this._uniqueID+'" /><div class="context" contenteditable="true" id="spell-context'+this._uniqueID+'"></div></div><div class="spell-ignorebtns"><button id="spelling-ignore'+this._uniqueID+'" type="button">Ignore</button><button id="spelling-ignore-all'+this._uniqueID+'" type="button">Ignore All</button></div><div class="clearleft top5">Suggestions:</div><div class="spell-suggest"><select size="8" id="spelling-suggestions'+this._uniqueID+'"><option></option></select></div><div class="spell-changebtns"><button type="button" id="spell-change'+
this._uniqueID+'">Change</button><button id="spell-change-all'+this._uniqueID+'">Change All</button><button type="button" id="spell-undo'+this._uniqueID+'">Undo</button></div><hr /><div class="close-box"><button type="button" id="spell-close'+this._uniqueID+'">Close</button></div></div>';document.body.appendChild(c);c.className="spell-msg";c.setAttribute("id","spell-msg"+this._uniqueID);c.innerHTML='<div class="spell-header">Spell Check</div><div class="spell-msg-inner"><span id="spell-msg-text'+
this._uniqueID+'"></span></div><div class="spell-msg-inner" id="spell-msg-close-box'+this._uniqueID+'"><button id="spell-msg-close'+this._uniqueID+'">OK</button></div>';document.body.appendChild(d);d.style.display="none";d.setAttribute("id","spell-hidden"+this._uniqueID)}};